<!-- AIG ForgeHub - Items List (RFQ / Bidding) -->

<div class="items-page">

  <!-- FILTER CARD -->
  <mat-card class="filter-card mat-elevation-z4">
    <mat-card-header>
      <mat-card-title>AIG ForgeHub – Items</mat-card-title>
      <mat-card-subtitle>RFQ / Bidding – Filter Items</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>

      <!-- Search Row -->
      <div class="filter-row">
        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Search Anything</mat-label>
          <input
            matInput
            placeholder="Code, name, description, specs..."
            [(ngModel)]="query.SearchAny"
            (input)="getItems()"
          />

          <button
            *ngIf="query.SearchAny"
            mat-icon-button
            matSuffix
            aria-label="Clear"
            (click)="query.SearchAny=''; getItems()"
          >
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>
      </div>

      <!-- Status + UOM Row -->
      <div class="filter-row gap">
        <!-- Status -->
        <mat-form-field appearance="outline">
          <mat-label>Status</mat-label>
          <mat-select [(ngModel)]="query.isActive" (selectionChange)="getItems()">
            <mat-option [value]="null">All</mat-option>
            <mat-option [value]="true">Active</mat-option>
            <mat-option [value]="false">Inactive</mat-option>
          </mat-select>
        </mat-form-field>

        <!-- UOM -->
        <mat-form-field appearance="outline">
          <mat-label>UOM</mat-label>
          <mat-select [(ngModel)]="query.uom" (selectionChange)="getItems()">
            <mat-option value="">All UOM</mat-option>
            <mat-option value="custom">custom</mat-option>
            <mat-option *ngFor="let i of uom" [value]="i">
              {{ i }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Total Items -->
      <div class="filter-footer">
        <span>Total Items: <strong>{{ totalItems }}</strong></span>
      </div>

    </mat-card-content>
  </mat-card>

  <!-- TABLE CARD -->
  <mat-card class="table-card mat-elevation-z4">
    <mat-card-header>
      <mat-card-title>Items</mat-card-title>
      <mat-card-subtitle>List of items used in RFQ & Bidding</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>

      <!-- MATERIAL TABLE -->
      <table mat-table [dataSource]="items" class="mat-elevation-z2 full-width">

        <!-- Item Code Column -->
        <ng-container matColumnDef="itemCode">
          <th mat-header-cell *matHeaderCellDef>Item Code</th>
          <td mat-cell *matCellDef="let i">{{ i.itemCode }}</td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let i">{{ i.name }}</td>
        </ng-container>

        <!-- Description Column -->
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef>Description</th>
          <td mat-cell *matCellDef="let i">{{ i.description }}</td>
        </ng-container>

        <!-- UOM Column -->
        <ng-container matColumnDef="uom">
          <th mat-header-cell *matHeaderCellDef>UOM</th>
          <td mat-cell *matCellDef="let i">{{ i.uom }}</td>
        </ng-container>

        <!-- Category Column -->
        <ng-container matColumnDef="categoryJson">
          <th mat-header-cell *matHeaderCellDef>Category</th>
          <td mat-cell *matCellDef="let i">{{ i.categoryJson }}</td>
        </ng-container>

        <!-- Specifications Column -->
        <ng-container matColumnDef="specifications">
          <th mat-header-cell *matHeaderCellDef>Specifications</th>
          <td mat-cell *matCellDef="let i">{{ i.specifications }}</td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let i">
            <button
              mat-icon-button
              color="primary"
              matTooltip="Update item"
              (click)="update(i.id)"
            >
              <mat-icon>edit</mat-icon>
            </button>

            <button
              mat-icon-button
              color="warn"
              matTooltip="Delete item"
              (click)="Delete(i.id)"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <!-- Header & Rows -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <!-- PAGINATOR (REPLACES PREVIOUS/NEXT BUTTONS) -->
      <mat-paginator
        [length]="totalItems || 0"
        [pageSize]="query.pageSize || 10"
        [pageIndex]="(query.pageNumber || 1) - 1"
        [pageSizeOptions]="[2, 5, 10, 20]"
        (page)="onPageChange($event)"
        showFirstLastButtons
      >
      </mat-paginator>

    </mat-card-content>
  </mat-card>

</div>
